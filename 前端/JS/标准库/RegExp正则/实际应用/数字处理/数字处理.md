# 数字处理

## 千分位显示

*   代码

    ```javascript
    // 千分位
    const str = "456454456";
    const reg = /\B(?=(\d{3})+$)/g
    const aa = str.replace(reg, ",");
    console.log(aa); // 456,454,456
    ```

## 货币格式化

*   1888 格式化成  1,888.00

    ```javascript
    function format (num) {
      return num.toFixed(2).replace(/\B(?=(\d{3})+\b)/g, ",").replace(/^/, "$$ ");
    };
    console.log( format(1888) );
    // => "$ 1,888.00"
    ```

## 只能输入 数字(含小数点)

*   js

    ```javascript
    const newVal = value.replace(/[^\d^\.]+/g,'');
    ```

## 整数正则

*   正整数正则

    ```javascript
    var posPattern = /^\d+$/;

    // 输出 true
    console.log(posPattern.test("42"));
    ```

    ```javascript
    Number.isInteger(Number(value))

    Number.isInteger(Number('')) // true
    Number.isInteger(Number('false')) // false
    Number.isInteger(Number('12')) // true
    Number.isInteger(Number(0)) // true

    ```

*   负整数正则

    ```javascript
    //输出 true
    console.log(negPattern.test("-42"));
    ```

*   整数正则

    ```javascript
    //输出 true
    console.log(intPattern.test("-42"));
    ```

## 数字正则

*   可以是整数也可以是浮点数

    ```javascript
    //正数正则
    var posPattern = /^\d*\.?\d+$/;

    //负数正则
    var negPattern = /^-\d*\.?\d+$/;
    //数字正则
    var numPattern = /^-?\d*\.?\d+$/;

    console.log(posPattern.test("42.2"));
    console.log(negPattern.test("-42.2"));
    console.log(numPattern.test("-42.2"));
    ```

## 字符串首尾是否含有数字

*   检验一个字符串首尾是否含有数字

    ```javascript
    const str = '123abc';
    const reg = /^\d|\d$/g;

    console.log(reg.test(str)); // true
    console.log(str.match(reg)); // [ '1' ]

    const str1 = 'a123abc5';

    console.log(reg.test(str1)); // true
    console.log(str1.match(reg)); // [ '5' ]

    const str2 = 'a123abc';

    console.log(reg.test(str2)); // false
    console.log(str2.match(reg)); // null
    ```

## 字符串首尾必须含有数字

*   检验一个字符串首尾必须含有数字

    ```javascript
    const reg = /^\d[\s\S]*\d$/g;
    const str = '123abc456';

    console.log(reg.test(str)); // true
    console.log(str.match(reg)); // [ '123abc456' ]

    const str1 = '123abc';

    console.log(reg.test(str1)); // false
    console.log(str1.match(reg)); // null
    ```

## 数字转大写金额

*   js

    ```javascript
    export const changeToChinese = (Num) => {
      //判断如果传递进来的不是字符的话转换为字符
      if (typeof Num == "number") {
        Num = new String(Num);
      };
      Num = Num.replace(/,/g, "") //替换tomoney()中的“,”
      Num = Num.replace(/ /g, "") //替换tomoney()中的空格
      Num = Num.replace(/￥/g, "") //替换掉可能出现的￥字符
      if (isNaN(Num)) { //验证输入的字符是否为数字
        //alert("请检查小写金额是否正确");
        return "";
      };
      //字符处理完毕后开始转换，采用前后两部分分别转换
      var part = String(Num).split(".");
      var newchar = "";
      //小数点前进行转化
      for (var i = part[0].length - 1; i >= 0; i--) {
          if (part[0].length > 10) {
              return "";
              //若数量超过拾亿单位，提示
          }
          var tmpnewchar = ""
          var perchar = part[0].charAt(i);
          switch (perchar) {
              case "0":
                  tmpnewchar = "零" + tmpnewchar;
                  break;
              case "1":
                  tmpnewchar = "壹" + tmpnewchar;
                  break;
              case "2":
                  tmpnewchar = "贰" + tmpnewchar;
                  break;
              case "3":
                  tmpnewchar = "叁" + tmpnewchar;
                  break;
              case "4":
                  tmpnewchar = "肆" + tmpnewchar;
                  break;
              case "5":
                  tmpnewchar = "伍" + tmpnewchar;
                  break;
              case "6":
                  tmpnewchar = "陆" + tmpnewchar;
                  break;
              case "7":
                  tmpnewchar = "柒" + tmpnewchar;
                  break;
              case "8":
                  tmpnewchar = "捌" + tmpnewchar;
                  break;
              case "9":
                  tmpnewchar = "玖" + tmpnewchar;
                  break;
          }
          switch (part[0].length - i - 1) {
              case 0:
                  tmpnewchar = tmpnewchar + "元";
                  break;
              case 1:
                  if (perchar != 0) tmpnewchar = tmpnewchar + "拾";
                  break;
              case 2:
                  if (perchar != 0) tmpnewchar = tmpnewchar + "佰";
                  break;
              case 3:
                  if (perchar != 0) tmpnewchar = tmpnewchar + "仟";
                  break;
              case 4:
                  tmpnewchar = tmpnewchar + "万";
                  break;
              case 5:
                  if (perchar != 0) tmpnewchar = tmpnewchar + "拾";
                  break;
              case 6:
                  if (perchar != 0) tmpnewchar = tmpnewchar + "佰";
                  break;
              case 7:
                  if (perchar != 0) tmpnewchar = tmpnewchar + "仟";
                  break;
              case 8:
                  tmpnewchar = tmpnewchar + "亿";
                  break;
              case 9:
                  tmpnewchar = tmpnewchar + "拾";
                  break;
          }
          var newchar = tmpnewchar + newchar;
      }
      //小数点之后进行转化
      if (Num.indexOf(".") != -1) {
          if (part[1].length > 2) {
              // alert("小数点之后只能保留两位,系统将自动截断");
              part[1] = part[1].substr(0, 2)
          }
          for (i = 0; i < part[1].length; i++) {
              tmpnewchar = ""
              perchar = part[1].charAt(i)
              switch (perchar) {
                  case "0":
                      tmpnewchar = "零" + tmpnewchar;
                      break;
                  case "1":
                      tmpnewchar = "壹" + tmpnewchar;
                      break;
                  case "2":
                      tmpnewchar = "贰" + tmpnewchar;
                      break;
                  case "3":
                      tmpnewchar = "叁" + tmpnewchar;
                      break;
                  case "4":
                      tmpnewchar = "肆" + tmpnewchar;
                      break;
                  case "5":
                      tmpnewchar = "伍" + tmpnewchar;
                      break;
                  case "6":
                      tmpnewchar = "陆" + tmpnewchar;
                      break;
                  case "7":
                      tmpnewchar = "柒" + tmpnewchar;
                      break;
                  case "8":
                      tmpnewchar = "捌" + tmpnewchar;
                      break;
                  case "9":
                      tmpnewchar = "玖" + tmpnewchar;
                      break;
              }
              if (i == 0) tmpnewchar = tmpnewchar + "角";
              if (i == 1) tmpnewchar = tmpnewchar + "分";
              newchar = newchar + tmpnewchar;
          }
      }
      //替换所有无用汉字
      while (newchar.search("零零") != -1)
          newchar = newchar.replace("零零", "零");
      newchar = newchar.replace("零亿", "亿");
      newchar = newchar.replace("亿万", "亿");
      newchar = newchar.replace("零万", "万");
      newchar = newchar.replace("零元", "元");
      newchar = newchar.replace("零角", "");
      newchar = newchar.replace("零分", "");
      if (newchar.charAt(newchar.length - 1) == "元") {
          newchar = newchar + "整"
      }
      return newchar;
    }
    ```

## 阿拉伯数字转中文大写数字

*   1000000 转成 一百万

    ```typescript
    function changeNumToHan(num:number) {
      const arr1 = ['零', '一', '二', '三', '四', '五', '六', '七', '八', '九'] as const;
      const arr2 = ['', '十', '百', '千', '万', '十', '百', '千', '亿', '十', '百', '千', '万', '十', '百', '千', '亿'] as const;
      if (!num || isNaN(num)) return '零';
      const english = num.toString().split('');
      let result = '';
      english.forEach((item,index) => {
        const des_i = english.length - 1 - index;// 倒序排列设值
        result = arr2[index] + result;
        const arr1_index = Number(english[des_i]);
        result = arr1[arr1_index] + result
        
      })

      result = result.replace(/零(千|百|十)/g, '零').replace(/十零/g, '十') // 将【零千、零百】换成【零】 【十零】换成【十】
      result = result.replace(/零+/g, '零') // 合并中间多个零为一个零
      result = result.replace(/零亿/g, '亿').replace(/零万/g, '万') // 将【零亿】换成【亿】【零万】换成【万】
      result = result.replace(/亿万/g, '亿') // 将【亿万】换成【亿】
      result = result.replace(/零+$/, '') // 移除末尾的零
      // 将【一十】换成【十】
      result = result.replace(/^一十/g, '十');

      return result;
    }
    ```
