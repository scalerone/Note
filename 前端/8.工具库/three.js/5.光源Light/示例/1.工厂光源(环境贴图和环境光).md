# 工厂光源(环境贴图和环境光)

## 设置类似工厂、园区等3D场景的光照

+ 环境贴图
+ 环境光
+ 平行光模拟太阳光

## 环境贴图

+ 如果你不设置任何光源和环境贴图，gltf模型默认PBR材质不会正常显示，一片漆黑。

+ 不过你不设置任何光源，只设置环境贴图，物体表面也能看到。虽然环境贴图不是光源，但是会模拟物体周围环境的反射光。就好比你站在街上，周围房子、树木、马路也会反射光线到你身上

+ 通过 `.envMapIntensity` 可以调节环境贴图对模型外表面的影响程度, `.envMapIntensity` 的值可以通过gui交互界面调节

  ```js
  const textureCube = new THREE.CubeTextureLoader()
    .setPath('./环境贴图/')
    .load(['px.jpg', 'nx.jpg', 'py.jpg', 'ny.jpg', 'pz.jpg', 'nz.jpg']);
  textureCube.encoding = THREE.sRGBEncoding;
  loader.load("../工厂.glb", function (gltf) {
    gltf.scene.traverse(function (obj) {
      if (obj.isMesh) { //判断是否是网格模型
        obj.material.envMap = textureCube; //设置环境贴图
        obj.material.envMapIntensity = 1.0;
      }
    });
  })
  ```

## 环境光

+ 一般三维场景需要添加环境光，来整体调节三维场景的明暗，环境光强度可以通过参数2，或光照强度属性 `.intensity` 设置

实际开发，可以先给一个大概的值，然后通过gui交互界面微调 `AmbientLight` 的光照强度属性 `.intensity`

  ```js
  const ambient = new THREE.AmbientLight(0xffffff, 0.4);
  scene.add(ambient);
  ```

## 平行光模拟太阳光

+ 比如实际生活中一个三维场景中，可能会有太阳光照射，太阳距离地球足够远，可以近似认为太阳光是平行光。

+ 工厂地面坐标为0的话，光源从斜上方照射到物体上，可以y给予一个大于0的高度值，xz设置不同的值，控制不同的光线照射方向。

+ 在设置光源高度的时候，你可以先大概测量下三场场景的尺寸，布局具体值，知道大概数量级即可，比如几十、几百，工厂长宽方向100量级，高度方向10量级

  ```js
  const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
  directionalLight.position.set(100, 60, 50);
  scene.add(directionalLight);
  ```
