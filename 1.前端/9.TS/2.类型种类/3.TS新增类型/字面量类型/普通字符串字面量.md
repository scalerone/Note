# 普通字符串字面量

## 概述

  - 除了常见的类型 `string` 和 `number` ，我们也可以将类型声明为更具体的数字或者字符串

  - 众所周知，在 JavaScript 中，有多种方式可以声明变量。比如 `var` 和 `let` ，这种方式声明的变量后续可以被修改，还有 `const` ，这种方式声明的变量则不能被修改，这就会影响 TypeScript 为字面量创建类型

## 联合类型

  - 字面量类型本身并没有什么太大用

    ```typescript
    let x: "hello" = "hello";
    // OK
    x = "hello";
    // ...
    x = "howdy";
    // Type '"howdy"' is not assignable to type '"hello"'
    ```

  - 如果结合联合类型，就显得有用多了。举个例子，当函数只能传入一些固定的字符串时

    ```typescript
    function printText(s: string, alignment: "left" | "right" | "center") {
      // ...
    }
    printText("Hello, world", "left");
    printText("G'day, mate", "centre"); // 类型“"centre"”的参数不能赋给类型“"left" | "right" | "center"”的参数
    ```

  - 数字字面量类型也是一样

    ```typescript
    // 只能返回 -1 0 1
    function compare(a: string, b: string): -1 | 0 | 1 {
      return a === b ? 0 : a > b ? 1 : -1;
    }
    ```

  - 跟非字面量类型联合

    ```typescript
    interface Options {
      width: number;
    }
    function configure(x: Options | "auto") {
      // ...
    }
    configure({ width: 100 });
    configure("auto");
    configure("automatic"); // 类型“"automatic"”的参数不能赋给类型“Options | "auto"”的参数

    ```

## 字面量推断

  - 当你初始化变量为一个对象的时候，TypeScript 会假设这个对象的属性的值未来会被修改

    ```typescript
    const obj = { counter: 0 };
    if (someCondition) {
      obj.counter = 1;
    }
    // TypeScript 并不会认为 obj.counter 之前是 0， 现在被赋值为 1 是一个错误。换句话说，obj.counter 必须是 number 类型，但不要求一定是 0，因为类型可以决定读写行为
    ```

  - 字符串

    ```typescript
    // 下面代码会报错
    // 原因：req.method 被推断为 string ，而不是 "GET"，因为在创建 req 和 调用 handleRequest 函数之间，可能还有其他的代码，或许会将 req.method 赋值一个新字符串比如 "Guess" 。所以 TypeScript 就报错了
    declare function handleRequest(url: string, method: "GET" | "POST"): void;

    const req = { url: "https://example.com", method: "GET" };
    handleRequest(req.url, req.method); // 报错：类型“string”的参数不能赋给类型“"GET" | "POST"”的参数

    ```

    ```typescript
    // 解决方案1：添加一个类型断言改变推断结果：
    const req = { url: "https://example.com", method: "GET" as "GET" };

    handleRequest(req.url, req.method as "GET");

    ```

    ```typescript
    // 解决方案2：使用 as const 把整个对象转为一个类型字面量
    const req = { url: "https://example.com", method: "GET" } as const;
    handleRequest(req.url, req.method);

    ```
